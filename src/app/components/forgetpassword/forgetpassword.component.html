<section class="my-5">
    <h1 class="text-main text-center my-4">Forget Password</h1>

    <!-- verify email -->
    @if (step==1) 
    {
        <form [formGroup]="verifyEmail" class="bg-main-light rounded-4 p-3 shadow" (ngSubmit)="verifyEmailSubmit()">
            <div class="my-2 py-3">
                <label for="email" class="fw-bold text-capitalize">email:</label>
                <input 
                [ngClass]="{
                    'is-valid': !verifyEmail.get('email')?.errors && (verifyEmail.get('email')?.touched || verifyEmail.get('email')?.dirty),
                    'is-invalid':verifyEmail.get('email')?.errors && (verifyEmail.get('email')?.touched || verifyEmail.get('email')?.dirty)
                }" type="email" id="email" class="form-control" formControlName="email">
    
                @if (verifyEmail.get('email')?.errors && (verifyEmail.get('email')?.touched || verifyEmail.get('email')?.dirty)) {
                    <div class="text-danger fw-bold mt-2">
                        @if (verifyEmail.get('email')?.getError('required')) {
                            <p class="m-0">Email is required</p>
                        }
                        @if (verifyEmail.get('email')?.getError('email')) {
                            <p class="m-0">Enter valid email</p>
                        }
                    </div>
                }
            </div>
            <button [disabled]="verifyEmail.invalid||isLoading" class="btn-main">Verify Email
                @if (isLoading) {
                    <i class="fas fa-spin fa-spinner"></i>
                }
            </button>
        </form>
    }
    @else if(step==2) 
    {
        <form [formGroup]="verifyCode" class="bg-main-light rounded-4 p-3 shadow" (ngSubmit)="verifyCodeSubmit()">
            <div class="my-2 py-3">
                <label for="resetCode" class="fw-bold text-capitalize">code:</label>
                <input 
                [ngClass]="{
                    'is-valid': !verifyCode.get('resetCode')?.errors && (verifyCode.get('resetCode')?.touched || verifyCode.get('resetCode')?.dirty),
                    'is-invalid':verifyCode.get('resetCode')?.errors && (verifyCode.get('resetCode')?.touched || verifyCode.get('resetCode')?.dirty)
                }" type="text" id="resetCode" class="form-control" formControlName="resetCode">
    
                @if (verifyCode.get('resetCode')?.errors && (verifyCode.get('resetCode')?.touched || verifyCode.get('resetCode')?.dirty)) {
                    <div class="text-danger fw-bold mt-2">
                        @if (verifyCode.get('resetCode')?.getError('required')) {
                            <p class="m-0">code is required</p>
                        }
                        @if (verifyCode.get('resetCode')?.getError('pattern')) {
                            <p class="m-0">Enter valid code</p>
                        }
                    </div>
                }
            </div>
            <button [disabled]="verifyCode.invalid||isLoading" class="btn-main">Verify Code
                @if (isLoading) {
                    <i class="fas fa-spin fa-spinner"></i>
                }
            </button>
        </form>
    }
    @else if (step==3) 
    {
        <!-- reset password -->

    <form [formGroup]="resetPassword" class="bg-main-light rounded-4 p-3 shadow my-2" (ngSubmit)="ResetPassSubmit()">
        <div class="my-2 py-3">
            <label for="email" class="fw-bold text-capitalize">email:</label>
            <input 
            [ngClass]="{
                'is-valid': !resetPassword.get('email')?.errors && (resetPassword.get('email')?.touched || resetPassword.get('email')?.dirty),
                'is-invalid':resetPassword.get('email')?.errors && (resetPassword.get('email')?.touched || resetPassword.get('email')?.dirty)
            }" type="email" id="email" class="form-control" formControlName="email">

            @if (resetPassword.get('email')?.errors && (resetPassword.get('email')?.touched || resetPassword.get('email')?.dirty)) {
                <div class="text-danger fw-bold mt-2">
                    @if (resetPassword.get('email')?.getError('required')) {
                        <p class="m-0">Email is required</p>
                    }
                    @if (resetPassword.get('email')?.getError('email')) {
                        <p class="m-0">Enter valid email</p>
                    }
                </div>
            }
        </div>

        <div class="my-2">
            <label for="newPassword" class="fw-bold text-capitalize">New Password:</label>
            <input [ngClass]="{
                'is-valid': !resetPassword.get('newPassword')?.errors && (resetPassword.get('newPassword')?.touched || resetPassword.get('newPassword')?.dirty),
                'is-invalid':resetPassword.get('newPassword')?.errors && (resetPassword.get('newPassword')?.touched || resetPassword.get('newPassword')?.dirty)
            }" type="password" id="newPassword" class="form-control" formControlName="newPassword">

            @if (resetPassword.get('newPassword')?.errors && (resetPassword.get('newPassword')?.touched || resetPassword.get('newPassword')?.dirty)) {
                <div class="text-danger fw-bold mt-2">
                    @if (resetPassword.get('newPassword')?.getError('required')) {
                        <p class="m-0">password is required</p>
                    }
                    @if (resetPassword.get('newPassword')?.getError('pattern')) {
                        <p class="m-0">Enter valid password</p>
                    }
                </div>
            }
        </div>
        <button [disabled]="resetPassword.invalid||isLoading" class="btn-main">Reset password
            @if (isLoading) {
                <i class="fas fa-spin fa-spinner"></i>
            }
        </button>
    </form>
    }
    

    
</section>

